#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: python3 generate_coursework.py "–¢–µ–º–∞ –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã"
"""

import sys
import os
from datetime import datetime
from docx import Document
from docx.shared import Pt, Cm, RGBColor
from docx.enum.text import WD_ALIGN_PARAGRAPH, WD_LINE_SPACING
from docx.oxml.ns import qn
from docx.oxml import OxmlElement

class CourseworkGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–±–æ—Ç —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –°–ü–±–ì–£"""

    def __init__(self, topic):
        self.topic = topic
        self.doc = Document()
        self._setup_document()

    def _setup_document(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞: –ø–æ–ª—è, —Å—Ç–∏–ª–∏"""
        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–µ–π –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π
        for section in self.doc.sections:
            section.left_margin = Cm(3.0)
            section.right_margin = Cm(1.5)
            section.top_margin = Cm(2.0)
            section.bottom_margin = Cm(2.0)

    def _create_element(self, name):
        return OxmlElement(name)

    def _create_attribute(self, element, name, value):
        element.set(qn(name), value)

    def _add_page_number(self):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü –≤–Ω–∏–∑—É –ø–æ —Ü–µ–Ω—Ç—Ä—É"""
        section = self.doc.sections[0]
        footer = section.footer
        paragraph = footer.paragraphs[0] if footer.paragraphs else footer.add_paragraph()
        paragraph.alignment = WD_ALIGN_PARAGRAPH.CENTER

        run = paragraph.add_run()
        fldChar1 = self._create_element('w:fldChar')
        self._create_attribute(fldChar1, 'w:fldCharType', 'begin')

        instrText = self._create_element('w:instrText')
        self._create_attribute(instrText, 'xml:space', 'preserve')
        instrText.text = "PAGE"

        fldChar2 = self._create_element('w:fldChar')
        self._create_attribute(fldChar2, 'w:fldCharType', 'end')

        run._r.append(fldChar1)
        run._r.append(instrText)
        run._r.append(fldChar2)

        run.font.name = 'Times New Roman'
        run.font.size = Pt(14)

    def _add_paragraph(self, text, style='normal', alignment='justify', bold=False, uppercase=False):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        para = self.doc.add_paragraph()

        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
        if alignment == 'center':
            para.alignment = WD_ALIGN_PARAGRAPH.CENTER
        elif alignment == 'justify':
            para.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
        elif alignment == 'left':
            para.alignment = WD_ALIGN_PARAGRAPH.LEFT

        # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞
        pf = para.paragraph_format
        if style == 'normal':
            pf.first_line_indent = Cm(1.25)
        pf.line_spacing_rule = WD_LINE_SPACING.ONE_POINT_FIVE
        pf.space_before = Pt(0)
        pf.space_after = Pt(0)

        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        run = para.add_run(text.upper() if uppercase else text)
        run.font.name = 'Times New Roman'
        run.font.size = Pt(14)
        run.font.bold = bold

        return para

    def _add_heading(self, text, level=1):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞"""
        if level == 1:  # –ì–ª–∞–≤—ã
            self._add_paragraph(text, style='heading', alignment='center', bold=True, uppercase=True)
        else:  # –ü–∞—Ä–∞–≥—Ä–∞—Ñ—ã
            self._add_paragraph(text, style='heading', alignment='justify', bold=True, uppercase=False)

    def generate_title_page(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏—Ç—É–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞"""
        # –ù–∞–∑–≤–∞–Ω–∏–µ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞
        self._add_paragraph('–°–ê–ù–ö–¢-–ü–ï–¢–ï–†–ë–£–†–ì–°–ö–ò–ô –ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–´–ô –£–ù–ò–í–ï–†–°–ò–¢–ï–¢',
                           style='heading', alignment='center', bold=False, uppercase=True)
        self.doc.add_paragraph()

        # –§–∞–∫—É–ª—å—Ç–µ—Ç –∏ –∫–∞—Ñ–µ–¥—Ä–∞
        self._add_paragraph('–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç', style='heading', alignment='center')
        self._add_paragraph('–ö–∞—Ñ–µ–¥—Ä–∞ [–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ñ–µ–¥—Ä—ã]', style='heading', alignment='center')

        # –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
        for _ in range(3):
            self.doc.add_paragraph()

        # –ö–£–†–°–û–í–ê–Ø –†–ê–ë–û–¢–ê
        self._add_paragraph('–ö–£–†–°–û–í–ê–Ø –†–ê–ë–û–¢–ê', style='heading', alignment='center', bold=True, uppercase=True)
        self.doc.add_paragraph()

        # –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞
        self._add_paragraph('–ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ ¬´[–ù–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã]¬ª', style='heading', alignment='center')
        self.doc.add_paragraph()

        # –¢–µ–º–∞
        self._add_paragraph('–Ω–∞ —Ç–µ–º—É:', style='heading', alignment='center')
        self._add_paragraph(f'¬´{self.topic}¬ª', style='heading', alignment='center', bold=False)

        # –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
        for _ in range(3):
            self.doc.add_paragraph()

        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—É–¥–µ–Ω—Ç–µ –∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ
        info_para = self.doc.add_paragraph()
        info_para.alignment = WD_ALIGN_PARAGRAPH.RIGHT
        info_text = """–í—ã–ø–æ–ª–Ω–∏–ª(–∞):
—Å—Ç—É–¥–µ–Ω—Ç(–∫–∞) ___ –∫—É—Ä—Å–∞
–æ—á–Ω–æ–π —Ñ–æ—Ä–º—ã –æ–±—É—á–µ–Ω–∏—è
–≥—Ä—É–ø–ø—ã ___________
[–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞]

–ù–∞—É—á–Ω—ã–π —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å:
[—É—á—ë–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å, –∑–≤–∞–Ω–∏–µ]
[–§–ò–û –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è]"""

        run = info_para.add_run(info_text)
        run.font.name = 'Times New Roman'
        run.font.size = Pt(14)

        # –ü—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
        for _ in range(4):
            self.doc.add_paragraph()

        # –ì–æ—Ä–æ–¥ –∏ –≥–æ–¥
        self._add_paragraph('–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', style='heading', alignment='center')
        self._add_paragraph(str(datetime.now().year), style='heading', alignment='center')

        # –†–∞–∑—Ä—ã–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        self.doc.add_page_break()

    def generate_content(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–≥–ª–∞–≤–ª–µ–Ω–∏—è"""
        self._add_heading('–°–û–î–ï–†–ñ–ê–ù–ò–ï', level=1)
        self.doc.add_paragraph()

        content_items = [
            '–í–í–ï–î–ï–ù–ò–ï',
            '–ì–õ–ê–í–ê 1. [–ù–ê–ó–í–ê–ù–ò–ï –ü–ï–†–í–û–ô –ì–õ–ê–í–´]',
            '  1.1. [–ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  1.2. [–ù–∞–∑–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  1.3. [–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '–ì–õ–ê–í–ê 2. [–ù–ê–ó–í–ê–ù–ò–ï –í–¢–û–†–û–ô –ì–õ–ê–í–´]',
            '  2.1. [–ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  2.2. [–ù–∞–∑–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  2.3. [–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '–ì–õ–ê–í–ê 3. [–ù–ê–ó–í–ê–ù–ò–ï –¢–†–ï–¢–¨–ï–ô –ì–õ–ê–í–´]',
            '  3.1. [–ù–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  3.2. [–ù–∞–∑–≤–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '  3.3. [–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞]',
            '–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï',
            '–°–ü–ò–°–û–ö –ò–°–¢–û–ß–ù–ò–ö–û–í'
        ]

        for item in content_items:
            self._add_paragraph(item, style='normal', alignment='left')

        self.doc.add_page_break()

    def generate_introduction(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–≤–µ–¥–µ–Ω–∏—è"""
        self._add_heading('–í–í–ï–î–ï–ù–ò–ï', level=1)
        self.doc.add_paragraph()

        sections = [
            ('–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–º—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '[–ó–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç–µ–º—ã: –ø–æ—á–µ–º—É —ç—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤–∞–∂–Ω–∞ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –ø—Ä–∞–≤–µ, –∫–∞–∫–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –æ–Ω–∞ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã –≤ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–µ –∏–ª–∏ –ø—Ä–∞–≤–æ–ø—Ä–∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç]'),

            ('–°—Ç–µ–ø–µ–Ω—å –Ω–∞—É—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ—Å—Ç–∏ —Ç–µ–º—ã',
             '[–£–∫–∞–∂–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–Ω–∏–º–∞–ª–∏—Å—å –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä: –ü—Ä–æ–±–ª–µ–º—ã [–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã] –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª–∏—Å—å –≤ —Ä–∞–±–æ—Ç–∞—Ö —Ç–∞–∫–∏—Ö —É—á—ë–Ω—ã—Ö, –∫–∞–∫ [—Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Ö –≤–∫–ª–∞–¥–∞]]'),

            ('–û–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '[–û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ä–µ–≥—É–ª–∏—Ä—É–µ–º—ã–µ –Ω–æ—Ä–º–∞–º–∏ –ø—Ä–∞–≤–∞ –≤ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º–æ–π —Å—Ñ–µ—Ä–µ]'),

            ('–ü—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '[–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–æ–≤—ã–µ –Ω–æ—Ä–º—ã, –∏–Ω—Å—Ç–∏—Ç—É—Ç—ã, —Å—É–¥–µ–±–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ —Ç–µ–º–µ —Ä–∞–±–æ—Ç—ã]'),

            ('–¶–µ–ª—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '[–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∞–≤–æ–≤–æ–≥–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è [—Ç–µ–º–∞ —Ä–∞–±–æ—Ç—ã], –≤—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏—é –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞]'),

            ('–ó–∞–¥–∞—á–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '1. [–ü–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞ - –æ–±—ã—á–Ω–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è: —Ä–∞—Å–∫—Ä—ã—Ç—å –ø–æ–Ω—è—Ç–∏–µ, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏]\n2. [–í—Ç–æ—Ä–∞—è –∑–∞–¥–∞—á–∞ - –∏–∑—É—á–∏—Ç—å –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ]\n3. [–¢—Ä–µ—Ç—å—è –∑–∞–¥–∞—á–∞ - –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É–¥–µ–±–Ω—É—é –ø—Ä–∞–∫—Ç–∏–∫—É]\n4. [–ß–µ—Ç–≤—ë—Ä—Ç–∞—è –∑–∞–¥–∞—á–∞ - –≤—ã—è–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã]\n5. [–ü—è—Ç–∞—è –∑–∞–¥–∞—á–∞ - —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]'),

            ('–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
             '–í —Ä–∞–±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –æ–±—â–µ–Ω–∞—É—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã (–∞–Ω–∞–ª–∏–∑, —Å–∏–Ω—Ç–µ–∑, –∏–Ω–¥—É–∫—Ü–∏—è, –¥–µ–¥—É–∫—Ü–∏—è) –∏ —á–∞—Å—Ç–Ω–æ-–Ω–∞—É—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã: —Ñ–æ—Ä–º–∞–ª—å–Ω–æ-—é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π, —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ-–ø—Ä–∞–≤–æ–≤–æ–π, –∏—Å—Ç–æ—Ä–∏–∫–æ-–ø—Ä–∞–≤–æ–≤–æ–π, —Å–∏—Å—Ç–µ–º–Ω–æ-—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π.'),

            ('–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã',
             f'–ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤–≤–µ–¥–µ–Ω–∏—è, —Ç—Ä—ë—Ö –≥–ª–∞–≤, –∑–∞–∫–ª—é—á–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.')
        ]

        for title, content in sections:
            para = self._add_paragraph(f'{title}. {content}', style='normal')

        self.doc.add_page_break()

    def generate_chapter(self, chapter_num, chapter_title, sections):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–ª–∞–≤—ã"""
        self._add_heading(f'–ì–õ–ê–í–ê {chapter_num}. {chapter_title}', level=1)
        self.doc.add_paragraph()

        for section_num, section_title, section_content in sections:
            self._add_heading(f'{chapter_num}.{section_num}. {section_title}', level=2)
            self.doc.add_paragraph()
            self._add_paragraph(section_content, style='normal')
            self.doc.add_paragraph()

        self.doc.add_page_break()

    def generate_conclusion(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–∫–ª—é—á–µ–Ω–∏—è"""
        self._add_heading('–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï', level=1)
        self.doc.add_paragraph()

        content = """[–í –∑–∞–∫–ª—é—á–µ–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∫—Ä–∞—Ç–∫–æ –∏–∑–ª–æ–∂–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã –ø–æ –∫–∞–∂–¥–æ–π –≥–ª–∞–≤–µ –∏ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–∫–ª—é—á–µ–Ω–∏—è:
1. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
2. –ö—Ä–∞—Ç–∫–∏–µ –≤—ã–≤–æ–¥—ã –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–¥–∞—á–∞–º –∏–∑ –≤–≤–µ–¥–µ–Ω–∏—è)
3. –û–±—â–∏–π –≤—ã–≤–æ–¥ –ø–æ —Ç–µ–º–µ —Ä–∞–±–æ—Ç—ã
4. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏—é –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)

–ó–∞–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º (2-3 —Å—Ç—Ä–∞–Ω–∏—Ü—ã) –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±—ã–ª–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏.]"""

        self._add_paragraph(content, style='normal')
        self.doc.add_page_break()

    def generate_bibliography(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"""
        self._add_heading('–°–ü–ò–°–û–ö –ò–°–¢–û–ß–ù–ò–ö–û–í', level=1)
        self.doc.add_paragraph()

        sections_bib = [
            ('I. –ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–æ–≤—ã–µ –∞–∫—Ç—ã', [
                '1. –ö–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏—è –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–∏–Ω—è—Ç–∞ –≤—Å–µ–Ω–∞—Ä–æ–¥–Ω—ã–º –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ–º 12.12.1993) (—Å —É—á—ë—Ç–æ–º –ø–æ–ø—Ä–∞–≤–æ–∫) // –°–ó –†–§. 2014. ‚Ññ 31. –°—Ç. 4398.',
                '2. [–î—Ä—É–≥–∏–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∞–∫—Ç—ã –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Å–∏–ª—ã]'
            ]),
            ('II. –°—É–¥–µ–±–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞', [
                '1. –ü–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–ª–µ–Ω—É–º–∞ –í–µ—Ä—Ö–æ–≤–Ω–æ–≥–æ –°—É–¥–∞ –†–§ –æ—Ç [–¥–∞—Ç–∞] ‚Ññ [–Ω–æ–º–µ—Ä] ¬´[–Ω–∞–∑–≤–∞–Ω–∏–µ]¬ª // –ë—é–ª–ª–µ—Ç–µ–Ω—å –í–µ—Ä—Ö–æ–≤–Ω–æ–≥–æ –°—É–¥–∞ –†–§. [–≥–æ–¥]. ‚Ññ [–Ω–æ–º–µ—Ä].',
                '2. [–î—Ä—É–≥–∏–µ –∞–∫—Ç—ã —Å—É–¥–µ–±–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏]'
            ]),
            ('III. –ù–∞—É—á–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞', [
                '1. [–§–∞–º–∏–ª–∏—è, –ò.–û. –ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ / –ò.–û. –§–∞–º–∏–ª–∏—è. ‚Äì –ú.: –ò–∑–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –≥–æ–¥. ‚Äì –ö–æ–ª-–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü.]',
                '2. [–§–∞–º–∏–ª–∏—è, –ò.–û. –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ / –ò.–û. –§–∞–º–∏–ª–∏—è // –ù–∞–∑–≤–∞–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞. ‚Äì –ì–æ–¥. ‚Äì ‚Ññ –Ω–æ–º–µ—Ä. ‚Äì –°. —Å—Ç—Ä–∞–Ω–∏—Ü—ã.]'
            ])
        ]

        for section_title, items in sections_bib:
            self._add_paragraph(section_title, style='normal', bold=True)
            for item in items:
                self._add_paragraph(item, style='normal')
            self.doc.add_paragraph()

    def save(self, filename):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞"""
        # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü
        self._add_page_number()

        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
        self.doc.save(filename)
        print(f"‚úÖ –î–æ–∫—É–º–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: {filename}")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    if len(sys.argv) < 2:
        print("‚ùå –û—à–∏–±–∫–∞: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —Ç–µ–º—É –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã")
        print("\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:")
        print('  python3 generate_coursework.py "–¢–µ–º–∞ –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã"')
        print("\n–ü—Ä–∏–º–µ—Ä:")
        print('  python3 generate_coursework.py "–ó–∞—â–∏—Ç–∞ –ø—Ä–∞–≤–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–º –ø—Ä–∞–≤–µ –†–§"')
        sys.exit(1)

    topic = ' '.join(sys.argv[1:])

    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã...")
    print(f"üìå –¢–µ–º–∞: {topic}")
    print()

    # –°–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
    generator = CourseworkGenerator(topic)

    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤
    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏—Ç—É–ª—å–Ω–æ–≥–æ –ª–∏—Å—Ç–∞...")
    generator.generate_title_page()

    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –æ–≥–ª–∞–≤–ª–µ–Ω–∏—è...")
    generator.generate_content()

    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –≤–≤–µ–¥–µ–Ω–∏—è...")
    generator.generate_introduction()

    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤...")
    # –ì–ª–∞–≤–∞ 1 (–ø—Ä–∏–º–µ—Ä)
    generator.generate_chapter(
        1,
        '[–ù–ê–ó–í–ê–ù–ò–ï –ü–ï–†–í–û–ô –ì–õ–ê–í–´ - –û–ë–´–ß–ù–û –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ê–Ø]',
        [
            (1, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.1]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.1 - –∑–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞—Å–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–Ω—è—Ç–∏—è, –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–∞–≤–æ–≤—ã—Ö –∏–Ω—Å—Ç–∏—Ç—É—Ç–æ–≤, –∏—Ö —Å—É—â–Ω–æ—Å—Ç—å]'),
            (2, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.2]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.2 - –∞–Ω–∞–ª–∏–∑ –ø—Ä–∞–≤–æ–≤–æ–π –ø—Ä–∏—Ä–æ–¥—ã, —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫]'),
            (3, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.3]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 1.3 - –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –≤–∏–¥—ã, —Ñ–æ—Ä–º—ã]')
        ]
    )

    # –ì–ª–∞–≤–∞ 2 (–ø—Ä–∏–º–µ—Ä)
    generator.generate_chapter(
        2,
        '[–ù–ê–ó–í–ê–ù–ò–ï –í–¢–û–†–û–ô –ì–õ–ê–í–´ - –û–ë–´–ß–ù–û –ù–û–†–ú–ê–¢–ò–í–ù–ê–Ø]',
        [
            (1, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.1]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.1 - –∞–Ω–∞–ª–∏–∑ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –ø—Ä–∞–≤–æ–≤–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ]'),
            (2, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.2]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.2 - –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–æ–≤–æ–≥–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤]'),
            (3, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.3]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 2.3 - –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞]')
        ]
    )

    # –ì–ª–∞–≤–∞ 3 (–ø—Ä–∏–º–µ—Ä)
    generator.generate_chapter(
        3,
        '[–ù–ê–ó–í–ê–ù–ò–ï –¢–†–ï–¢–¨–ï–ô –ì–õ–ê–í–´ - –û–ë–´–ß–ù–û –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø]',
        [
            (1, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.1]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.1 - –∞–Ω–∞–ª–∏–∑ —Å—É–¥–µ–±–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏]'),
            (2, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.2]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.2 - –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∞–≤–æ–ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è]'),
            (3, '[–ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.3]', '[–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞ 3.3 - –∑–∞—Ä—É–±–µ–∂–Ω—ã–π –æ–ø—ã—Ç –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏—é]')
        ]
    )

    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è...")
    generator.generate_conclusion()

    print("‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤...")
    generator.generate_bibliography()

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ —Ç–µ–º—ã
    safe_topic = topic[:50].replace('/', '_').replace('\\', '_').replace(':', '_')
    filename = f"–ö—É—Ä—Å–æ–≤–∞—è_{safe_topic}.docx"

    print()
    generator.save(filename)

    print()
    print("=" * 60)
    print("‚úÖ –ö–£–†–°–û–í–ê–Ø –†–ê–ë–û–¢–ê –£–°–ü–ï–®–ù–û –°–û–ó–î–ê–ù–ê!")
    print("=" * 60)
    print()
    print("üìã –ß—Ç–æ –¥–∞–ª—å—à–µ:")
    print("1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ Microsoft Word –∏–ª–∏ LibreOffice")
    print("2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —à–∞–±–ª–æ–Ω–Ω—ã–µ –ø–æ–ª—è [–≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö]")
    print("3. –ó–∞–º–µ–Ω–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –ø–æ –≤–∞—à–µ–π —Ç–µ–º–µ")
    print("4. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ —Å–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã")
    print("5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ —á–µ–∫-–ª–∏—Å—Ç–∞–º (docs/–ß–ï–ö_–õ–ò–°–¢–´.md)")
    print()
    print("üí° –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Claude AI:")
    print("   - –û—Ç–∫—Ä–æ–π—Ç–µ docs/–ë–ò–ë–õ–ò–û–¢–ï–ö–ê_–ü–†–û–ú–ü–¢–û–í.md")
    print("   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è")
    print()

if __name__ == '__main__':
    main()
